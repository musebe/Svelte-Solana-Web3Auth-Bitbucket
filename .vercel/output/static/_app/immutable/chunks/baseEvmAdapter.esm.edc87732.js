import{K as h,L as d,C as l,u as g,z as a,M as E,N as m,O as p,Q as u,R as w,S as f,w as C}from"./authFunctions.2a27f1e8.js";class N extends h{async init(e){this.chainConfig||(this.chainConfig=d(l.EIP155,1))}async authenticateUser(){if(!this.provider||this.status!==g.CONNECTED)throw a.notConnectedError();const{chainNamespace:e,chainId:o}=this.chainConfig,t=await this.provider.request({method:"eth_accounts"});if(t&&t.length>0){const n=E(t[0],this.name);if(n&&!m(n))return{idToken:n};const r={domain:window.location.origin,uri:window.location.href,address:t[0],chainId:parseInt(o,16),version:"1",nonce:Math.random().toString(36).slice(2),issuedAt:new Date().toISOString()},s=await p(r,e),c=await this.provider.request({method:"personal_sign",params:[s,t[0]]}),i=await u(e,c,s,this.name,this.sessionTime,this.clientId,this.web3AuthNetwork);return w(t[0],this.name,i),{idToken:i}}throw a.notConnectedError("Not connected with wallet, Please login/connect first")}async disconnectSession(){super.checkDisconnectionRequirements();const e=await this.provider.request({method:"eth_accounts"});e&&e.length>0&&f(e[0],this.name)}async disconnect(){this.rehydrated=!1,this.emit(C.DISCONNECTED)}}export{N as B};
